$(()=>{async function e(){function e(e){return e.replace(/^\s+/g,"").replace(/\s+$/g,"")}function t(e){const t=new RegExp("^(http(s)://)[a-zA-Z0-9.-]*[a-zA-Z0-9/_-]","g");return t.test(e)}function o(){S.length=0;const e=D.getLength();for(let t=0;t<e;t++)S.push(`${D.getAt(t).lat()}|${D.getAt(t).lng()}`);ge=S.join("\n"),ge=`${ge}\n${A.strokeWeight}`+"|"+A.strokeOpacity+"|"+A.strokeColor,$("#element_type").val("polyline"),$("#post_excerpt").val(ge)}function s(){S.length=0;const e=j.getLength();for(let t=0;t<e;t++)S.push(`${j.getAt(t).lat()}|${j.getAt(t).lng()}`);ge=S.join("\n"),ge=`${ge}\n${K.strokeWeight}`+"|"+K.strokeOpacity+"|"+K.strokeColor+"|"+K.fillColor+"|"+K.fillOpacity,$("#element_type").val("polygon"),$("#post_excerpt").val(ge)}function l(){const e=V.getBounds(),t=e.getNorthEast(),o=e.getSouthWest(),s=new google.maps.LatLng(t.lat(),o.lng()),l=new google.maps.LatLng(o.lat(),t.lng());ge=`${l.lat()}|${s.lng()}|${s.lat()}|${l.lng()}`,ge=`${ge}\n${V.strokeWeight}`+"|"+V.strokeOpacity+"|"+V.strokeColor+"|"+V.fillColor+"|"+V.fillOpacity,$("#element_type").val("rectangle"),$("#post_excerpt").val(ge)}function a(){const e=Z.getCenter(),t=Z.getRadius();ge=`${e.lat()}|${e.lng()}|${t}`,ge=`${ge}\n${Z.strokeWeight}`+"|"+Z.strokeOpacity+"|"+Z.strokeColor+"|"+Z.fillColor+"|"+Z.fillOpacity,$("#element_type").val("circle"),$("#post_excerpt").val(ge)}function i(){const e=document.getElementById("address").value;geocoder.geocode({address:e,partialmatch:!0},r)}function r(e,t){"OK"==t&&e.length>0?W.fitBounds(e[0].geometry.viewport):alert(`Geocode was not successful for the following reason: ${t}`)}function n(e,t){let o;return function(){const s=arguments,l=()=>e.apply(this,s);clearTimeout(o),o=setTimeout(l,t)}}function p(e){marker=new google.maps.Marker({position:e,icon:`${ne}pf=myGmaps/icons/marker.png`,draggable:!0,map:W}),B.push(marker),ae.setContent(ce),google.maps.event.addListener(marker,"click",function(){ae.open(W,this)}),google.maps.event.addListener(marker,"dragend",()=>{ge=`${marker.position.lat()}|${marker.position.lng()}|${marker.icon}`,$("#post_excerpt").val(ge)}),ge=`${marker.position.lat()}|${marker.position.lng()}|${marker.icon}`,$("#element_type").val("point of interest"),$("#post_excerpt").val(ge)}function c(e){D.push(e),A.setMap(W),o()}function g(e){j.push(e),K.setMap(W),s()}function d(e){const t=2**W.getZoom();V.setBounds(new google.maps.LatLngBounds(new google.maps.LatLng((e.lat()*t-50)/t,(e.lng()*t-75)/t),new google.maps.LatLng((e.lat()*t+50)/t,(e.lng()*t+75)/t))),V.setMap(W),l()}function m(e){const t=2**(10*Math.PI-W.getZoom()),o=t/500;Z.setOptions({radius:o,center:e}),Z.setMap(W),a()}function _(e){const t=[];if(""!=$("#kmls_list").val()){$("#kmls_base_url").val();const e=$("#kmls_list").val(),o=e.split(",");for(ue in o)this_kml=`<li>${o[ue]}</li>`,t.push(this_kml)}let o=t.join();if(o=`<ul>${o.replace(/\,/g,"")}</ul>`,""!=t)var s=`<h4>${custom_kmls_msg}</h4>`+'<div style="max-height: 100px;overflow: auto">'+o+"</div><hr />";else s="";const l='<div id="infowindow_kml" style="cursor: pointer">'+s+"<h4>"+kml_url_msg+'</h4><p><input type="text" id="kml_url" size="80" value="'+$("#post_excerpt").val()+'" /></p><p><input type="button" id="save" value="OK" /></p></div>';ae.setPosition(e),ae.setContent(l),ae.open(W)}function u(e){const t='<div id="infowindow_georss" style="cursor: pointer"><h4>'+geoRss_url_msg+'</h4><p><input type="text" id="geoRss_url" size="80" value="'+$("#post_excerpt").val()+'" /></p><p><input type="button" id="save" value="OK" /></p></div>';ae.setPosition(e),ae.setContent(t),ae.open(W)}function v(e){const t="#555",o=.8,s=3,l='<div id="infowindow_directions" style="cursor: pointer"><div class="two-cols clearfix"><div class="col70"><p><label for="directions_start">'+directions_start_msg+'</label><input type="text" id="directions_start" size="40" value="" /></p><p><label for="directions_end">'+directions_end_msg+'</label><input type="text" id="directions_end" size="40" value="" /></p><p><label for="directions_show"><input type="checkbox" id="directions_show" />'+directions_show_msg+'</label></p></div><div class="col30"><p><label for="stroke_color">'+stroke_color_msg+'</label><input type="text" id="stroke_color" size="10" class="colorpicker" value="'+t+'" /></p><p><label for="stroke_opacity">'+stroke_opacity_msg+'</label><input type="text" id="stroke_opacity" size="10" value="'+o+'" /></p><p><label for="stroke_weight">'+stroke_weight_msg+'</label><input type="text" id="stroke_weight" size="10" value="'+s+'" /></p></div></div><p><input type="button" id="save" value="OK" /></div>';ae.setPosition(e),ae.setContent(l),ae.open(W);const a=document.getElementById("directions_start");new google.maps.places.Autocomplete(a);const i=document.getElementById("directions_end");new google.maps.places.Autocomplete(i)}function y(){for(ue in $(".map_toolbar button").each(function(){$(this).removeClass("active"),$(this).removeClass("inactive")}),$("#delete_map").trigger("blur"),B)B[ue].setMap(null);B.length=0,S.length=0,A.setOptions({}),D.clear(),A.setMap(null),K.setOptions({}),j.clear(),K.setMap(null),V.setOptions({}),V.setMap(null),Z.setOptions({}),Z.setMap(null),Y.setOptions({}),Y.setMap(null),Q.setOptions({}),Q.setMap(null),se.clear(),J.setMap(null),te.setMap(null),$("#element_type").val("notype"),$("#post_excerpt").val("")}const{Map:k}=await google.maps.importLibrary("maps"),{Places:f}=await google.maps.importLibrary("places");if($(".map_toolbar button").on("click",function(){"delete_map"==$(this).attr("id")?y():""==$("#post_excerpt").val()&&($(".map_toolbar button").each(function(){$(this).removeClass("active")}),$(this).addClass("active"))}),""==$("input[name=myGmaps_center]").val())var h=new google.maps.LatLng(43.0395797336425,6.126280043989323),w="12",b="roadmap";else{var O=$("input[name=myGmaps_center]").val().split(","),x=parseFloat(e(O[0])),L=parseFloat(e(O[1]));h=new google.maps.LatLng(x,L),w=$("input[name=myGmaps_zoom]").val(),b=$("input[name=myGmaps_type]").val()}const C=[{featureType:"water",elementType:"geometry",stylers:[{color:"#193341"}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#2c5a71"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#29768a"},{lightness:-37}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#406d80"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#406d80"}]},{elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#3e606f"},{weight:2},{gamma:.84}]},{elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"administrative",elementType:"geometry",stylers:[{weight:.6},{color:"#1a3541"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#2c5a71"}]}],M=new google.maps.StyledMapType(C,{name:"Neutral Blue"}),T=[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.HYBRID,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.TERRAIN,"OpenStreetMap","neutral_blue"],F=$("#map_styles_list").val(),I=F.split(",");for(ue in I){G=I[ue].replace("_styles.js",""),T.push(G);const e=dotclear.getData(G);window[G]=new google.maps.StyledMapType(e.style,{name:e.name})}const z={zoom:parseFloat(w),center:h,scrollwheel:!1,mapTypeControl:!0,overviewMapControl:!0,streetViewControl:!1,mapTypeControlOptions:{mapTypeIds:T}},W=new google.maps.Map(document.getElementById("map_canvas"),z),P='<a href="https://www.openstreetmap.org/copyright">Â© OpenStreetMap Contributors</a>',R=document.createElement("div");for(ue in R.id="credit-control",R.index=0,"roadmap"==b?W.setOptions({mapTypeId:google.maps.MapTypeId.ROADMAP}):"satellite"==b?W.setOptions({mapTypeId:google.maps.MapTypeId.SATELLITE}):"hybrid"==b?W.setOptions({mapTypeId:google.maps.MapTypeId.HYBRID}):"terrain"==b?W.setOptions({mapTypeId:google.maps.MapTypeId.TERRAIN}):"OpenStreetMap"==b?(W.setOptions({mapTypeId:"OpenStreetMap"}),W.controls[google.maps.ControlPosition.BOTTOM_RIGHT].push(R),R.innerHTML=P):W.setOptions({mapTypeId:b}),W.mapTypes.set("neutral_blue",M),W.mapTypes.set("OpenStreetMap",new google.maps.ImageMapType({getTileUrl:(e,t)=>`https://tile.openstreetmap.org/${t}/${e.x}/${e.y}.png`,tileSize:new google.maps.Size(256,256),name:"OpenStreetMap",maxZoom:18})),T)if(!(ue<6)){var G=window[T[ue]];W.mapTypes.set(T[ue],G)}geocoder=new google.maps.Geocoder,$("#geocode").on("click",()=>(i(),!1));var A,B=[],S=[];const E={strokeColor:"#555",strokeOpacity:.8,strokeWeight:3,draggable:!0,editable:!0};A=new google.maps.Polyline(E);var K,D=A.getPath();const H={strokeColor:"#555",strokeOpacity:.8,strokeWeight:3,fillColor:"#ccc",fillOpacity:.35,draggable:!0,editable:!0};K=new google.maps.Polygon(H);var V,j=K.getPath();const N={strokeColor:"#555",strokeOpacity:.8,strokeWeight:3,fillColor:"#ccc",fillOpacity:.35,draggable:!0,editable:!0};var Z;V=new google.maps.Rectangle(N);const U={strokeColor:"#555",strokeOpacity:.8,strokeWeight:3,fillColor:"#ccc",fillOpacity:.35,center:h,draggable:!0,editable:!0,radius:1e3};var Y,Q;Z=new google.maps.Circle(U),Y=new google.maps.KmlLayer({}),Q=new google.maps.KmlLayer({});const q=new google.maps.DirectionsService;var J,X={strokeColor:"#555",strokeOpacity:.8,strokeWeight:3},ee={polylineOptions:X},te=new google.maps.DirectionsRenderer(ee);const oe={strokeColor:"#555",strokeOpacity:0,strokeWeight:20,zIndex:1};J=new google.maps.Polyline(oe);var se=J.getPath();const le=document.getElementById("address");new google.maps.places.Autocomplete(le);google.maps.event.addListener(W,"click",e=>{ae.close();let t="none";const o=$(".map_toolbar button.active").length>0;$(".map_toolbar button").each(function(){$(this).hasClass("active")?t=$(this).attr("id"):o&&$(this).addClass("inactive")}),"add_marker"==t?""==$("#post_excerpt").val()&&p(e.latLng):"add_polyline"==t?c(e.latLng):"add_polygon"==t?g(e.latLng):"add_kml"==t?""==$("#post_excerpt").val()&&_(e.latLng):"add_georss"==t?""==$("#post_excerpt").val()&&u(e.latLng):"add_rectangle"==t?""==$("#post_excerpt").val()&&d(e.latLng):"add_circle"==t?""==$("#post_excerpt").val()&&m(e.latLng):"add_directions"==t&&""==$("#post_excerpt").val()&&v(e.latLng)}),google.maps.event.addListener(W,"maptypeid_changed",()=>{"OpenStreetMap"==W.getMapTypeId()?(W.controls[google.maps.ControlPosition.BOTTOM_RIGHT].push(R),R.innerHTML=P):W.controls[google.maps.ControlPosition.BOTTOM_RIGHT].clear(R)}),google.maps.event.addListener(A,"rightclick",e=>{null!=e.vertex&&A.getPath().removeAt(e.vertex)}),google.maps.event.addListener(D,"insert_at",n(()=>{o()},250)),google.maps.event.addListener(D,"remove_at",n(()=>{o()},250)),google.maps.event.addListener(D,"set_at",n(()=>{o()},250)),google.maps.event.addListener(A,"click",function(e){const t='<div id="infowindow_polyline" class="col"><p><label for="stroke_color">'+stroke_color_msg+'</label><input type="text" id="stroke_color" size="10" class="colorpicker" value="'+this.strokeColor+'" /></p><p><label for="stroke_opacity">'+stroke_opacity_msg+'</label><input type="text" id="stroke_opacity" size="10" value="'+this.strokeOpacity+'" /></p><p><label for="stroke_weight">'+stroke_weight_msg+'</label><input type="text" id="stroke_weight" size="10" value="'+this.strokeWeight+'" /></p><p><input type="button" id="save" value="OK" /></p></div>';ae.setPosition(e.latLng),ae.setContent(t),ae.open(W)}),google.maps.event.addListener(K,"rightclick",e=>{null!=e.vertex&&K.getPath().removeAt(e.vertex)}),google.maps.event.addListener(j,"insert_at",n(()=>{s()},250)),google.maps.event.addListener(j,"remove_at",n(()=>{s()},250)),google.maps.event.addListener(j,"set_at",n(()=>{s()},250)),google.maps.event.addListener(K,"click",function(e){const t='<div id="infowindow_polygon"><div class="two-boxes"<p><label for="stroke_color">'+stroke_color_msg+'</label><input type="text" id="stroke_color" size="10" class="colorpicker" value="'+this.strokeColor+'" /></p><p><label for="stroke_opacity">'+stroke_opacity_msg+'</label><input type="text" id="stroke_opacity" size="10" value="'+this.strokeOpacity+'" /></p><p><label for="stroke_weight">'+stroke_weight_msg+'</label><input type="text" id="stroke_weight" size="10" value="'+this.strokeWeight+'" /></p></div><div class="two-boxes"<p><label for="fill_color">'+fill_color_msg+'</label><input type="text" id="fill_color" size="10" value="'+this.fillColor+'" /></p><p><label for="fill_opacity">'+fill_opacity_msg+'</label><input type="text" id="fill_opacity" size="10" value="'+this.fillOpacity+'" /></p></div><p><input type="button" id="save" value="OK" /></p></div>';ae.setPosition(e.latLng),ae.setContent(t),ae.open(W)}),google.maps.event.addListener(V,"bounds_changed",n(()=>{l()},250)),google.maps.event.addListener(V,"dragend",n(()=>{l()},250)),google.maps.event.addListener(V,"click",function(e){const t='<div id="infowindow_rectangle"><div class="two-boxes"<p><label for="stroke_color">'+stroke_color_msg+'</label><input type="text" id="stroke_color" size="10" class="colorpicker" value="'+this.strokeColor+'" /></p><p><label for="stroke_opacity">'+stroke_opacity_msg+'</label><input type="text" id="stroke_opacity" size="10" value="'+this.strokeOpacity+'" /></p><p><label for="stroke_weight">'+stroke_weight_msg+'</label><input type="text" id="stroke_weight" size="10" value="'+this.strokeWeight+'" /></p></div><div class="two-boxes"<p><label for="fill_color">'+fill_color_msg+'</label><input type="text" id="fill_color" size="10" value="'+this.fillColor+'" /></p><p><label for="fill_opacity">'+fill_opacity_msg+'</label><input type="text" id="fill_opacity" size="10" value="'+this.fillOpacity+'" /></p></div><p><input type="button" id="save" value="OK" /></p></div>';ae.setPosition(e.latLng),ae.setContent(t),ae.open(W)}),google.maps.event.addListener(Z,"center_changed",n(()=>{a()},250)),google.maps.event.addListener(Z,"radius_changed",n(()=>{a()},250)),google.maps.event.addListener(Z,"click",function(e){const t='<div id="infowindow_circle"><div class="two-boxes"<p><label for="stroke_color">'+stroke_color_msg+'</label><input type="text" id="stroke_color" size="10" class="colorpicker" value="'+this.strokeColor+'" /></p><p><label for="stroke_opacity">'+stroke_opacity_msg+'</label><input type="text" id="stroke_opacity" size="10" value="'+this.strokeOpacity+'" /></p><p><label for="stroke_weight">'+stroke_weight_msg+'</label><input type="text" id="stroke_weight" size="10" value="'+this.strokeWeight+'" /></p></div><div class="two-boxes"<p><label for="fill_color">'+fill_color_msg+'</label><input type="text" id="fill_color" size="10" value="'+this.fillColor+'" /></p><p><label for="fill_opacity">'+fill_opacity_msg+'</label><input type="text" id="fill_opacity" size="10" value="'+this.fillOpacity+'" /></p><p><label for="circle_radius">'+circle_radius_msg+'</label><input type="text" id="circle_radius" size="10" value="'+this.radius+'" /></p></div><p><input type="button" id="save" value="OK" /></p></div>';ae.setPosition(e.latLng),ae.setContent(t),ae.open(W)}),google.maps.event.addListener(Y,"click",e=>{const t=[];if(""!=$("#kmls_list").val()){$("#kmls_base_url").val();const e=$("#kmls_list").val(),o=e.split(",");for(ue in o)this_kml=`<li>${o[ue]}</li>`,t.push(this_kml)}let o=t.join();if(o=`<ul>${o.replace(/\,/g,"")}</ul>`,""!=t)var s=`<h4>${custom_kmls_msg}</h4>`+'<div style="max-height: 100px;overflow: auto">'+o+"</div><hr />";else s="";const l='<div id="infowindow_kml" style="cursor: pointer">'+s+"<h4>"+kml_url_msg+'</h4><p><input type="text" id="kml_url" size="80" value="'+$("#post_excerpt").val()+'" /></p><p><input type="button" id="save" value="OK" /></p></div>';ae.setPosition(e.latLng),ae.setContent(l),ae.open(W)}),google.maps.event.addListener(Q,"click",e=>{const t='<div id="infowindow_georss" style="cursor: pointer"><h4>'+geoRss_url_msg+'</h4><p><input type="text" id="geoRss_url" size="80" value="'+$("#post_excerpt").val()+'" /></p><p><input type="button" id="save" value="OK" /></p></div>';ae.setPosition(e.latLng),ae.setContent(t),ae.open(W)}),google.maps.event.addListener(J,"click",e=>{const t=ge.split("|"),o=t[0],s=t[1],l=t[2],a=t[3],i=t[4],r=t[5];if("true"==r)var n='checked = "checked"';else n="";const p='<div id="infowindow_directions" style="cursor: pointer"><div class="two-cols clearfix"><div class="col70"><p><label for="directions_start">'+directions_start_msg+'</label><input type="text" id="directions_start" size="40" value="'+o+'" /></p><p><label for="directions_end">'+directions_end_msg+'</label><input type="text" id="directions_end" size="40" value="'+s+'" /></p><p><label for="directions_show"><input type="checkbox" id="directions_show" '+n+" />"+directions_show_msg+'</label></p></div><div class="col30"><p><label for="stroke_color">'+stroke_color_msg+'</label><input type="text" id="stroke_color" size="10" class="colorpicker" value="'+i+'" /><p><label for="stroke_opacity">'+stroke_opacity_msg+'</label><input type="text" id="stroke_opacity" size="10" value="'+a+'" /><p><label for="stroke_weight">'+stroke_weight_msg+'</label><input type="text" id="stroke_weight" size="10" value="'+l+'" /></div></div><p><input type="button" id="save" value="OK" /></div>';ae.setPosition(e.latLng),ae.setContent(p),ae.open(W);const c=document.getElementById("directions_start");new google.maps.places.Autocomplete(c);const g=document.getElementById("directions_end");new google.maps.places.Autocomplete(g)});var ae=new google.maps.InfoWindow({});const ie=[];if(""!=$("#icons_list").val()){const e=$("#icons_base_url").val(),t=$("#icons_list").val(),o=t.split(",");for(ue in o){const t=`<img src="${e}${o[ue]}" alt="${o[ue]}" />`;ie.push(t)}}let re=ie.join();re=re.replace(/\,/g,"");var ne=$("#plugin_QmarkURL").val();if(""!=re)var pe=`<h4>${custom_icons_msg}</h4>`+'<div id="custom_icons_list">'+re+"</div><hr />";else pe="";var ce='<div id="infowindow_icons" style="cursor: pointer">'+pe+'<div id="default_icons_list"><h4>'+default_icons_msg+'</h4><img src="'+ne+'pf=myGmaps/icons/marker-blue.png" alt="marker-blue.png"  /><img src="'+ne+'pf=myGmaps/icons/marker-green.png" alt="marker-green.png"  /><img src="'+ne+'pf=myGmaps/icons/marker-grey.png" alt="marker-grey.png"  /><img src="'+ne+'pf=myGmaps/icons/marker-orange.png" alt="marker-orange.png"  /><img src="'+ne+'pf=myGmaps/icons/marker-purple.png" alt="marker-purple.png"  /><img src="'+ne+'pf=myGmaps/icons/marker-yellow.png" alt="marker-yellow.png"  /><img src="'+ne+'pf=myGmaps/icons/marker.png" alt="marker.png"  />&nbsp;</div></div>';$(document).on("click","#infowindow_icons img",function(){let e=$("#post_excerpt").val();const t=e.split("|");parseFloat(t[0]),parseFloat(t[1]);marker.setIcon($(this).attr("src"));const o=$(this).attr("src");e=`${marker.position.lat()}|${marker.position.lng()}|${o}`,$("#post_excerpt").val(e),ae.close()}),$(document).on("click","#infowindow_polyline #save",()=>{const e=$("#stroke_color").val(),t=$("#stroke_opacity").val(),s=$("#stroke_weight").val();A.setOptions({strokeColor:e,strokeOpacity:parseFloat(t),strokeWeight:parseFloat(s)}),o(),ae.close()}),$(document).on("click","#infowindow_polygon #save",()=>{const e=$("#stroke_color").val(),t=$("#stroke_opacity").val(),o=$("#stroke_weight").val(),l=$("#fill_color").val(),a=$("#fill_opacity").val();K.setOptions({strokeColor:e,strokeOpacity:parseFloat(t),strokeWeight:parseFloat(o),fillColor:l,fillOpacity:parseFloat(a)}),s(),ae.close()}),$(document).on("click","#infowindow_rectangle #save",()=>{const e=$("#stroke_weight").val(),t=$("#stroke_opacity").val(),o=$("#stroke_color").val(),s=$("#fill_color").val(),a=$("#fill_opacity").val();V.setOptions({strokeColor:o,strokeOpacity:parseFloat(t),strokeWeight:parseFloat(e),fillColor:s,fillOpacity:parseFloat(a)}),l(),ae.close()}),$(document).on("click","#infowindow_circle #save",()=>{const e=$("#stroke_weight").val(),t=$("#stroke_opacity").val(),o=$("#stroke_color").val(),s=$("#fill_color").val(),l=$("#fill_opacity").val(),i=$("#circle_radius").val();Z.setOptions({strokeColor:o,strokeOpacity:parseFloat(t),strokeWeight:parseFloat(e),fillColor:s,fillOpacity:parseFloat(l),radius:parseFloat(i)}),a(),ae.close()}),$(document).on("click","#infowindow_kml li",function(){const e=$("#kmls_base_url").val()+$(this).text();$("#kml_url").val(e).focus()}),$(document).on("click","#infowindow_kml #save",()=>{Y.setMap(null);const e=$("#kml_url").val();null!=e&&""!=e&&t(e)&&(Y.setOptions({url:e,preserveViewport:!0,suppressInfoWindows:!0}),$("#element_type").val("included kml file"),$("#post_excerpt").val(e)),Y.setMap(W),ae.close()}),$(document).on("click","#infowindow_georss #save",()=>{Q.setMap(null);const e=$("#geoRss_url").val();null!=e&&""!=e&&t(e)&&(Q.setOptions({url:e,preserveViewport:!0,suppressInfoWindows:!0}),$("#element_type").val("GeoRSS feed"),$("#post_excerpt").val(e)),Q.setMap(W),ae.close()}),$(document).on("click","#infowindow_directions #save",()=>{const e=$("#directions_start").val(),t=$("#directions_end").val(),o=$("#directions_show").prop("checked"),s=$("#stroke_color").val(),l=$("#stroke_opacity").val(),a=$("#stroke_weight").val(),i={strokeColor:s,strokeOpacity:l,strokeWeight:a},r={polylineOptions:i},n={origin:e,destination:t,travelMode:google.maps.TravelMode.DRIVING};q.route(n,(e,t)=>{if(t==google.maps.DirectionsStatus.OK){const t=e.routes[0].overview_path;J.setPath(t),te.setOptions({options:r}),te.setDirections(e),te.setMap(W)}}),ge=`${e}|${t}|${a}`+"|"+l+"|"+s+"|"+o,$("#element_type").val("directions"),$("#post_excerpt").val(ge),te.setMap(W),J.setMap(W),ae.close()});var ge=$("#post_excerpt").val();const de=$("input[name=element_type]").val();if("point of interest"==de){O=ge.split("|"),x=parseFloat(O[0]),L=parseFloat(O[1]);const e=O[2];var me=new google.maps.LatLng(x,L);marker=new google.maps.Marker({position:me,draggable:!0,icon:e,map:W}),B.push(marker),$("#add_marker").addClass("active"),ae.setContent(ce),google.maps.event.addListener(marker,"click",function(){ae.open(W,this)}),google.maps.event.addListener(marker,"dragend",()=>{ge=`${marker.position.lat()}|${marker.position.lng()}|${e}`,$("#post_excerpt").val(ge)})}else if("polyline"==de){for(var _e=ge.split("\n"),ue=0;ue<_e.length-1;ue++){O=_e[ue].split("|"),x=parseFloat(O[0]),L=parseFloat(O[1]),me=new google.maps.LatLng(x,L);D.push(me)}const e=_e.pop();O=e.split("|");var ve=parseFloat(O[0]),ye=parseFloat(O[1]),ke=O[2];A.setOptions({strokeColor:ke,strokeOpacity:parseFloat(ye),strokeWeight:parseFloat(ve)}),D=A.getPath(),A.setMap(W),$("#add_polyline").addClass("active")}else if("polygon"==de){for(_e=ge.split("\n"),ue=0;ue<_e.length-1;ue++){O=_e[ue].split("|"),x=parseFloat(O[0]),L=parseFloat(O[1]),me=new google.maps.LatLng(x,L);j.push(me)}const e=_e.pop();O=e.split("|"),ve=parseFloat(O[0]),ye=parseFloat(O[1]),ke=O[2];var fe=O[3],he=parseFloat(O[4]);K.setOptions({strokeColor:ke,strokeOpacity:parseFloat(ye),strokeWeight:parseFloat(ve),fillColor:fe,fillOpacity:parseFloat(he)}),j=K.getPath(),K.setMap(W),$("#add_polygon").addClass("active")}else if("rectangle"==de){_e=ge.split("\n"),O=_e[0].split("|");const e=parseFloat(O[0]),t=parseFloat(O[1]),o=parseFloat(O[2]),s=parseFloat(O[3]);bounds=new google.maps.LatLngBounds(new google.maps.LatLng(e,t),new google.maps.LatLng(o,s)),V.setBounds(bounds);var $e=_e[1].split("|");ve=parseFloat($e[0]),ye=parseFloat($e[1]),ke=$e[2],fe=$e[3],he=parseFloat($e[4]);V.setOptions({strokeColor:ke,strokeOpacity:parseFloat(ye),strokeWeight:parseFloat(ve),fillColor:fe,fillOpacity:parseFloat(he)}),$("#add_rectangle").addClass("active"),V.setMap(W)}else if("circle"==de){_e=ge.split("\n"),O=_e[0].split("|"),x=parseFloat(O[0]),L=parseFloat(O[1]);const e=parseFloat(O[2]);me=new google.maps.LatLng(x,L),$e=_e[1].split("|"),ve=parseFloat($e[0]),ye=parseFloat($e[1]),ke=$e[2],fe=$e[3],he=parseFloat($e[4]);Z.setOptions({strokeColor:ke,strokeOpacity:parseFloat(ye),strokeWeight:parseFloat(ve),fillColor:fe,fillOpacity:parseFloat(he),center:me,radius:parseFloat(e)}),$("#add_circle").addClass("active"),Z.setMap(W)}else if("included kml file"==de)Y.setOptions({url:ge,preserveViewport:!0,suppressInfoWindows:!0}),$("#add_kml").addClass("active"),Y.setMap(W);else if("GeoRSS feed"==de)Q.setOptions({url:ge,preserveViewport:!0,suppressInfoWindows:!0}),$("#add_georss").addClass("active"),Q.setMap(W);else if("directions"==de){O=ge.split("|");const e=O[0],t=O[1];ve=O[2],ye=O[3],ke=O[4],X={strokeColor:ke,strokeOpacity:ye,strokeWeight:ve},ee={polylineOptions:X};const o={origin:e,destination:t,travelMode:google.maps.TravelMode.DRIVING};q.route(o,(e,t)=>{if(t==google.maps.DirectionsStatus.OK){const t=e.routes[0].overview_path;J.setPath(t),te.setOptions({options:ee}),te.setDirections(e),te.setMap(W)}}),$("#add_directions").addClass("active"),J.setMap(W)}$(".map_toolbar button").each(function(){$(this).hasClass("active")||$(this).addClass("inactive")}),$("#entry-form").submit(()=>{const e=$("#element_type").val();""==e&&$("#element_type").val("notype");const t=`${W.getCenter().lat()},${W.getCenter().lng()}`,o=W.getZoom(),s=W.getMapTypeId();return $("input[name=myGmaps_center]").attr("value",t),$("input[name=myGmaps_zoom]").attr("value",o),$("input[name=myGmaps_type]").attr("value",s),!0})}if(!document.getElementById)return;if(!document.getElementById("map_canvas"))return;e()});