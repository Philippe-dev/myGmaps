"use strict";dotclear.ready(()=>{async function e(){function e(){const e=document.getElementById("address").value;E.geocode({address:e,partialmatch:!0},o)}function o(e,t){"OK"===t&&e.length>0?map.fitBounds(e[0].geometry.viewport):alert(`Geocode was not successful for the following reason: ${t}`)}function e(){const e=document.getElementById("address").value;E.geocode({address:e,partialmatch:!0},o)}function o(e,o){"OK"==o&&e.length>0?t.fitBounds(e[0].geometry.viewport):alert(`Geocode was not successful for the following reason: ${o}`)}function a(e){return e.replace(/^\s+/g,"").replace(/\s+$/g,"")}function n(){const e=`${t.getCenter().lat()},${t.getCenter().lng()}`,o=t.getZoom(),a=t.getMapTypeId();r.value=e,m.value=o,i.value=a}const{Map:s}=await google.maps.importLibrary("maps"),{Places:l}=await google.maps.importLibrary("places"),{AdvancedMarkerElement:p}=await google.maps.importLibrary("marker"),r=document.querySelector('input[name="myGmaps_center"]'),m=document.querySelector('input[name="myGmaps_zoom"]'),i=document.querySelector('input[name="myGmaps_type"]');let d,c,g;if(""===r.value)g=new google.maps.LatLng(43.0395797336425,6.126280043989323),d="12",c="roadmap",r.value=g,m.value=d,i.value=c;else{const e=r.value.split(","),t=parseFloat(a(e[0])),o=parseFloat(a(e[1]));g=new google.maps.LatLng(t,o),d=m.value,c=i.value}const y=[{featureType:"water",elementType:"geometry",stylers:[{color:"#193341"}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#2c5a71"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#29768a"},{lightness:-37}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#406d80"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#406d80"}]},{elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#3e606f"},{weight:2},{gamma:.84}]},{elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"administrative",elementType:"geometry",stylers:[{weight:.6},{color:"#1a3541"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#2c5a71"}]}],u=new google.maps.StyledMapType(y,{name:"Neutral Blue"}),T=[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.HYBRID,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.TERRAIN,"OpenStreetMap","neutral_blue"],f=document.getElementById("map_styles_list").value,I=f.split(",");for(const e in I){const t=I[e].replace("_styles.js","");T.push(t);const o=dotclear.getData(t);window[t]=new google.maps.StyledMapType(o.style,{name:o.name})}const w={mapId:"add_map",zoom:parseFloat(d),center:g,scrollwheel:!1,mapTypeControl:!0,streetViewControl:!1,mapTypeControlOptions:{mapTypeIds:T}};t=new s(document.getElementById("map_canvas"),w);const v='<a href="https://www.openstreetmap.org/copyright">Â© OpenStreetMap Contributors</a>',M=document.createElement("div");M.id="credit-control",M.style.fontSize="10px",M.style.fontFamily="Arial, sans-serif",M.style.margin="0",M.style.whitespace="nowrap",M.index=0,"roadmap"==c?t.setOptions({mapTypeId:google.maps.MapTypeId.ROADMAP}):"satellite"==c?t.setOptions({mapTypeId:google.maps.MapTypeId.SATELLITE}):"hybrid"==c?t.setOptions({mapTypeId:google.maps.MapTypeId.HYBRID}):"terrain"==c?t.setOptions({mapTypeId:google.maps.MapTypeId.TERRAIN}):"OpenStreetMap"==c?(t.setOptions({mapTypeId:"OpenStreetMap"}),t.controls[google.maps.ControlPosition.BOTTOM_RIGHT].push(M),M.innerHTML=v):t.setOptions({mapTypeId:c}),t.mapTypes.set("neutral_blue",u),t.mapTypes.set("OpenStreetMap",new google.maps.ImageMapType({getTileUrl:(e,t)=>`https://tile.openstreetmap.org/${t}/${e.x}/${e.y}.png`,tileSize:new google.maps.Size(256,256),name:"OpenStreetMap",maxZoom:18}));for(const e in T){if(e<6)continue;const o=window[T[e]];t.mapTypes.set(T[e],o)}const E=new google.maps.Geocoder,O=document.getElementById("address"),h=document.getElementById("geocode"),B=document.getElementById("map_toolbar"),L=new google.maps.places.PlaceAutocompleteElement;B.insertBefore(L,h),L.addEventListener("gmp-select",async({placePrediction:e})=>{const t=e.toPlace();await t.fetchFields({fields:["displayName","formattedAddress","location"]}),O.value=t.formattedAddress}),document.getElementById("geocode").addEventListener("click",t=>{t.preventDefault(),e()}),google.maps.event.addListener(t,"center_changed",()=>{window.setTimeout(()=>{t.getCenter()},100),n()}),google.maps.event.addListener(t,"zoom_changed",()=>{n()}),google.maps.event.addListener(t,"maptypeid_changed",()=>{"OpenStreetMap"==t.getMapTypeId()?(t.controls[google.maps.ControlPosition.BOTTOM_RIGHT].push(M),M.innerHTML=v):t.controls[google.maps.ControlPosition.BOTTOM_RIGHT].clear(M),n()}),"function"==typeof initElements&&initElements(t),document.getElementById("geocode").addEventListener("click",t=>{t.preventDefault(),e()})}if(!document.getElementById)return;if(!document.getElementById("map_canvas"))return;let t;e()});