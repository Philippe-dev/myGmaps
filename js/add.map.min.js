$(()=>{async function e(){function e(){const e=document.getElementById("address").value;geocoder.geocode({address:e,partialmatch:!0},a)}function a(e,a){"OK"==a&&e.length>0?t.fitBounds(e[0].geometry.viewport):alert(`Geocode was not successful for the following reason: ${a}`)}function o(e){return e.replace(/^\s+/g,"").replace(/\s+$/g,"")}function p(){if(""==$('input[name="myGmaps_center"]').attr("value"))var e=new google.maps.LatLng(43.0395797336425,6.126280043989323),a="12";else{const t=$('input[name="myGmaps_center"]').attr("value").split(","),p=parseFloat(o(t[0])),n=parseFloat(o(t[1]));e=new google.maps.LatLng(p,n),a=$('input[name="myGmaps_zoom"]').attr("value"),$('input[name="myGmaps_type"]').attr("value")}google.maps.event.trigger(t,"resize"),t.setCenter(e),t.setZoom(parseFloat(a))}function n(){const e=`${t.getCenter().lat()},${t.getCenter().lng()}`,a=t.getZoom(),o=t.getMapTypeId();$("input[name=myGmaps_center]").attr("value",e),$("input[name=myGmaps_zoom]").attr("value",a),$("input[name=myGmaps_type]").attr("value",o)}const{Map:s}=await google.maps.importLibrary("maps"),{Places:l}=await google.maps.importLibrary("places");if(""==$('input[name="myGmaps_center"]').attr("value")){var r=new google.maps.LatLng(43.0395797336425,6.126280043989323),m="12",g="roadmap";$('input[name="myGmaps_center"]').attr("value",r),$('input[name="myGmaps_zoom"]').attr("value",m),$('input[name="myGmaps_type"]').attr("value",g)}else{const e=$('input[name="myGmaps_center"]').attr("value").split(","),t=parseFloat(o(e[0])),a=parseFloat(o(e[1]));r=new google.maps.LatLng(t,a),m=$('input[name="myGmaps_zoom"]').attr("value"),g=$('input[name="myGmaps_type"]').attr("value")}const y=[{featureType:"water",elementType:"geometry",stylers:[{color:"#193341"}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#2c5a71"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#29768a"},{lightness:-37}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#406d80"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#406d80"}]},{elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#3e606f"},{weight:2},{gamma:.84}]},{elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"administrative",elementType:"geometry",stylers:[{weight:.6},{color:"#1a3541"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#2c5a71"}]}],c=new google.maps.StyledMapType(y,{name:"Neutral Blue"}),d=[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.HYBRID,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.TERRAIN,"OpenStreetMap","neutral_blue"],u=$("#map_styles_list").attr("value"),T=u.split(",");for(i in T){v=T[i].replace("_styles.js",""),d.push(v);const e=dotclear.getData(v);window[v]=new google.maps.StyledMapType(e.style,{name:e.name})}const f={zoom:parseFloat(m),center:r,scrollwheel:!1,mapTypeControl:!0,streetViewControl:!1,mapTypeControlOptions:{mapTypeIds:d}};t=new s(document.getElementById("map_canvas"),f);const w='<a href="https://www.openstreetmap.org/copyright">Â© OpenStreetMap Contributors</a>',I=document.createElement("div");for(i in I.id="credit-control",I.style.fontSize="10px",I.style.fontFamily="Arial, sans-serif",I.style.margin="0",I.style.whitespace="nowrap",I.index=0,"roadmap"==g?t.setOptions({mapTypeId:google.maps.MapTypeId.ROADMAP}):"satellite"==g?t.setOptions({mapTypeId:google.maps.MapTypeId.SATELLITE}):"hybrid"==g?t.setOptions({mapTypeId:google.maps.MapTypeId.HYBRID}):"terrain"==g?t.setOptions({mapTypeId:google.maps.MapTypeId.TERRAIN}):"OpenStreetMap"==g?(t.setOptions({mapTypeId:"OpenStreetMap"}),t.controls[google.maps.ControlPosition.BOTTOM_RIGHT].push(I),I.innerHTML=w):t.setOptions({mapTypeId:g}),t.mapTypes.set("neutral_blue",c),t.mapTypes.set("OpenStreetMap",new google.maps.ImageMapType({getTileUrl:(e,t)=>`https://tile.openstreetmap.org/${t}/${e.x}/${e.y}.png`,tileSize:new google.maps.Size(256,256),name:"OpenStreetMap",maxZoom:18})),d)if(!(i<6)){var v=window[d[i]];t.mapTypes.set(d[i],v)}geocoder=new google.maps.Geocoder;const M=document.getElementById("address");new google.maps.places.Autocomplete(M);google.maps.event.addListener(t,"center_changed",()=>{window.setTimeout(()=>{t.getCenter()},100),n()}),google.maps.event.addListener(t,"zoom_changed",()=>{n()}),google.maps.event.addListener(t,"maptypeid_changed",()=>{"OpenStreetMap"==t.getMapTypeId()?(t.controls[google.maps.ControlPosition.BOTTOM_RIGHT].push(I),I.innerHTML=w):t.controls[google.maps.ControlPosition.BOTTOM_RIGHT].clear(I),n()}),initElements(t),$("#settings").on("onetabload",()=>{p()}),$("#gmap-area label").on("click",()=>{p()}),$("#geocode").on("click",()=>(e(),!1))}if(!document.getElementById)return;if(!document.getElementById("map_canvas"))return;let t;e()});